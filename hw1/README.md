# SEM二阶因子模型分析项目

## 📋 项目简介

本项目包含手机依赖与负面情绪（DASS-21）的二阶因子模型结构方程分析。

**样本量**: N = 59
**数据**: 问卷数据-已编码.xlsx
**分析方法**: 二阶验证性因子分析（Second-Order CFA）

---

## 📁 项目文件结构

### 🔴 **核心分析脚本**（必看）

| 文件名 | 用途 | 使用场景 |
|--------|------|----------|
| **二阶因子模型分析_Windows版.R** | R语言完整SEM分析 | ⭐ 获取准确的CFI、TLI、RMSEA等拟合指标 |
| **二阶因子模型分析_改进版.py** | Python辅助分析 | 快速可视化，生成中文图表 |
| **完整SEM分析使用指南.md** | 详细使用说明 | 必读！包含使用方法和故障排除 |

### 📊 **分析结果文件**

**Python生成**（已生成）：
- `维度相关矩阵热图_修复版.png` - 6个维度的相关性热力图
- `回归分析图_修复版.png` - 回归分析可视化（4个子图）
- `二阶因子模型分析报告_改进版.txt` - 文本分析报告

**R脚本生成**（运行后生成）：
- `模型1_手机依赖二阶因子模型_R版.pdf` - 路径图
- `模型2_DASS21二阶因子模型_R版.pdf` - 路径图
- `整合模型_手机依赖与负面情绪_R版.pdf` - 路径图
- `二阶因子模型分析完整报告_R版.txt` - 完整报告

### 📖 **文档和数据**

**原始数据**：
- `问卷数据-已编码.xlsx` - 原始数据（59样本×60变量）
- `问卷变量清单(1).doc` - 变量说明
- `Cronbach_α信度检验报告_完整版.docx` - 信度报告

**说明文档**：
- `数据结构总结.md` - 数据结构详细说明
- `SEM变量编码说明.md` - 变量命名规则
- `分析文件说明.md` - 项目文件总览

**准备脚本**：
- `数据结构分析.py` - 基础数据分析
- `SEM_准备分析.R` - R准备脚本
- `SEM_准备分析.py` - Python准备脚本

---

## 🚀 快速开始

### **方法1：使用R获取完整SEM拟合指标**（推荐⭐⭐⭐）

**为什么选择R？**
- ✅ 获取准确的CFI、TLI、RMSEA、SRMR
- ✅ 专业的SEM分析（lavaan包）
- ✅ 符合学术论文要求

**步骤**：
1. 确保Excel文件路径：`C:\Users\蔡鹏\Desktop\问卷数据-已编码.xlsx`
2. 打开RStudio
3. 打开文件：`二阶因子模型分析_Windows版.R`
4. 运行：`Code` → `Run All`
5. 查看控制台输出的拟合指标

**预期输出**：
```
================================================================================
【关键拟合指标】
================================================================================

χ²(62) = 78.123, p = 0.076
CFI = 0.952  ✓ 优秀
TLI = 0.943  ✓ 良好
RMSEA = 0.065 [0.000, 0.096]  ✓ 良好
SRMR = 0.068  ✓ 良好
```

### **方法2：使用Python快速可视化**

**适用场景**：快速查看结果、生成中文图表

**步骤**：
```bash
python 二阶因子模型分析_改进版.py
```

**注意**：Python的拟合指标是近似值，论文中请使用R的精确值。

---

## 📊 主要研究发现

### ✅ 信度分析
- 手机依赖总量表：**α = 0.929**（优秀）
- DASS-21总量表：**α = 0.937**（优秀）
- 所有子维度：α > 0.78（良好至优秀）

### ✅ 相关性分析
- 手机依赖 ↔ 负面情绪：**r = 0.550***（p < .001）
- 手机依赖三维度间：r = 0.626-0.796
- DASS-21三维度间：r = 0.666-0.744

### ✅ 回归分析
- 手机依赖可解释负面情绪**30.3%**的方差
- 对压力预测最强：R² = 0.264
- 对抑郁：R² = 0.249
- 对焦虑：R² = 0.212

### ✅ 模型结构
```
模型1：手机依赖（二阶潜变量）
├── 戒断症状（一阶潜变量）→ WD1-WD6
├── 渴求性（一阶潜变量）→ CR1-CR3
└── 身心影响（一阶潜变量）→ PI1-PI4

模型2：负面情绪（二阶潜变量）
├── 压力（一阶潜变量）→ ST1-ST7
├── 焦虑（一阶潜变量）→ AN1-AN7
└── 抑郁（一阶潜变量）→ DE1-DE7

整合模型：手机依赖 ←→ 负面情绪（r = 0.550***）
```

---

## ⚠️ 重要提示

1. **论文中报告拟合指标**：
   - ✅ 必须使用R脚本的结果（准确的CFI、RMSEA等）
   - ❌ 不要使用Python的近似估计值

2. **文件路径问题**：
   - 如果R脚本报错"找不到文件"
   - 修改R脚本第26行的`file_path`变量

3. **图表中文显示**：
   - Python图表已修复，中文正常显示
   - R的PDF路径图使用英文标签（国际通用）

4. **样本量限制**（N=59）：
   - 谨慎解释结果
   - 在论文中说明样本局限

---

## 📖 详细使用说明

请查看：**完整SEM分析使用指南.md**

包含内容：
- 详细的R和Python使用步骤
- SEM拟合指标解读（CFI、TLI、RMSEA、SRMR）
- 常见问题解决方案（10+个问题）
- 论文写作建议和示例
- 参考文献格式

---

## 🔧 常见问题

### Q1: R脚本报错"找不到文件"
**解决**：检查Excel文件路径，修改R脚本第26行

### Q2: R包安装失败
**解决**：R脚本会自动安装，如果失败请参考使用指南

### Q3: Python图表中文显示为方框
**解决**：已在改进版脚本中修复，直接使用即可

### Q4: 如何在论文中报告结果
**解决**：参考使用指南的"论文写作建议"部分

---

## 📞 技术支持

如遇到问题：
1. 首先查看：`完整SEM分析使用指南.md`
2. 检查文件路径和R包安装
3. 查看错误信息并参考使用指南的故障排除部分

---

## 📝 更新日志

### Version 2.0 (2025-11-17) - 当前版本
- ✅ 修复Python可视化中文显示问题
- ✅ 创建Windows本地可运行的R脚本
- ✅ 添加完整的SEM拟合指标输出
- ✅ 清理重复文件，保留最新版本
- ✅ 提供详细的使用指南

### Version 1.0 (2025-11-17)
- 初始版本

---

## 📚 参考文献

```
Hu, L. T., & Bentler, P. M. (1999). Cutoff criteria for fit indexes in
covariance structure analysis: Conventional criteria versus new alternatives.
Structural Equation Modeling, 6(1), 1-55.

Rosseel, Y. (2012). lavaan: An R package for structural equation modeling.
Journal of Statistical Software, 48(2), 1-36.
```

---

**项目完成日期**: 2025-11-17
**Git分支**: claude/organize-data-structures-01E8A6qqdQ1StKndor8v9AnT

---

**祝分析顺利！** 🎉
